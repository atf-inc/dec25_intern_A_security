{
  "version": "1.0",
  "name": "QuantumShield Threat Response Policies",
  "description": "Policies for threat detection and response",
  
  "threat_levels": {
    "critical": {
      "score_threshold": 0.95,
      "color": "#FF0000",
      "auto_block": true,
      "block_duration_minutes": 10080,
      "alert_priority": "critical",
      "notifications": ["email", "sms", "slack", "webhook"],
      "require_approval": false
    },
    "high": {
      "score_threshold": 0.80,
      "color": "#FF6600",
      "auto_block": true,
      "block_duration_minutes": 1440,
      "alert_priority": "high",
      "notifications": ["email", "slack", "webhook"],
      "require_approval": false
    },
    "medium": {
      "score_threshold": 0.60,
      "color": "#FFCC00",
      "auto_block": false,
      "rate_limit": true,
      "alert_priority": "medium",
      "notifications": ["email", "webhook"],
      "require_approval": true
    },
    "low": {
      "score_threshold": 0.40,
      "color": "#00CC00",
      "auto_block": false,
      "alert_priority": "low",
      "notifications": ["webhook"],
      "require_approval": false
    },
    "info": {
      "score_threshold": 0.20,
      "color": "#0066FF",
      "auto_block": false,
      "alert_priority": "info",
      "notifications": [],
      "require_approval": false
    }
  },
  
  "attack_categories": {
    "ddos": {
      "enabled": true,
      "severity_multiplier": 1.2,
      "response_actions": ["rate_limit", "block", "alert", "log"],
      "thresholds": {
        "syn_flood": {
          "packets_per_second": 1000,
          "action": "block"
        },
        "udp_flood": {
          "packets_per_second": 5000,
          "action": "rate_limit"
        },
        "http_flood": {
          "requests_per_second": 100,
          "action": "rate_limit"
        }
      }
    },
    "intrusion": {
      "enabled": true,
      "severity_multiplier": 1.5,
      "response_actions": ["block", "quarantine", "alert", "log"],
      "subcategories": {
        "port_scan": {
          "threshold_ports": 10,
          "time_window_seconds": 60,
          "action": "block"
        },
        "brute_force": {
          "threshold_attempts": 5,
          "time_window_seconds": 300,
          "action": "block"
        },
        "exploit_attempt": {
          "action": "block"
        }
      }
    },
    "malware": {
      "enabled": true,
      "severity_multiplier": 2.0,
      "response_actions": ["block", "quarantine", "alert", "log", "sample_capture"],
      "subcategories": {
        "ransomware": {
          "action": "block",
          "isolate_host": true
        },
        "trojan": {
          "action": "block"
        },
        "worm": {
          "action": "block"
        },
        "botnet": {
          "action": "block"
        }
      }
    },
    "web_attack": {
      "enabled": true,
      "severity_multiplier": 1.3,
      "response_actions": ["block", "alert", "log"],
      "subcategories": {
        "sql_injection": {
          "action": "block"
        },
        "xss": {
          "action": "block"
        },
        "csrf": {
          "action": "block"
        },
        "path_traversal": {
          "action": "block"
        },
        "command_injection": {
          "action": "block"
        }
      }
    },
    "data_exfiltration": {
      "enabled": true,
      "severity_multiplier": 1.8,
      "response_actions": ["block", "quarantine", "alert", "log"],
      "thresholds": {
        "outbound_data_mb": 100,
        "unusual_destination": true,
        "encrypted_tunnel": true
      }
    },
    "reconnaissance": {
      "enabled": true,
      "severity_multiplier": 0.8,
      "response_actions": ["rate_limit", "alert", "log"],
      "subcategories": {
        "dns_enumeration": {
          "threshold_queries": 50,
          "action": "rate_limit"
        },
        "service_discovery": {
          "action": "log"
        }
      }
    }
  },
  
  "correlation_rules": {
    "kill_chain_detection": {
      "enabled": true,
      "stages": ["reconnaissance", "weaponization", "delivery", "exploitation", "installation", "c2", "actions"],
      "time_window_minutes": 60,
      "min_stages_for_alert": 3,
      "severity": "critical"
    },
    "lateral_movement": {
      "enabled": true,
      "threshold_hosts": 3,
      "time_window_minutes": 30,
      "severity": "high"
    },
    "coordinated_attack": {
      "enabled": true,
      "threshold_sources": 5,
      "threshold_events": 100,
      "time_window_minutes": 10,
      "severity": "high"
    }
  },
  
  "adaptive_response": {
    "enabled": true,
    "learning_mode": false,
    "escalation": {
      "enabled": true,
      "repeat_offense_multiplier": 1.5,
      "time_window_hours": 24
    },
    "de_escalation": {
      "enabled": true,
      "clean_period_hours": 168,
      "reduction_factor": 0.5
    }
  },
  
  "exceptions": {
    "whitelisted_ips": [],
    "whitelisted_domains": [],
    "excluded_rules": [],
    "maintenance_windows": []
  }
}

