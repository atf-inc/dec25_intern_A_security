{
  "version": "1.0",
  "name": "QuantumShield Default Firewall Rules",
  "description": "Default firewall policy configuration",
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z",
  
  "default_policies": {
    "input": "DROP",
    "output": "ACCEPT",
    "forward": "DROP"
  },
  
  "zones": {
    "trusted": {
      "description": "Internal trusted network",
      "networks": ["192.168.0.0/16", "10.0.0.0/8"],
      "default_action": "ACCEPT"
    },
    "untrusted": {
      "description": "External untrusted network",
      "networks": ["0.0.0.0/0"],
      "default_action": "DROP"
    },
    "dmz": {
      "description": "Demilitarized zone",
      "networks": ["172.16.0.0/16"],
      "default_action": "INSPECT"
    }
  },
  
  "rules": [
    {
      "id": 1,
      "name": "allow_established",
      "description": "Allow established and related connections",
      "enabled": true,
      "priority": 100,
      "direction": "INPUT",
      "protocol": "all",
      "source": "any",
      "destination": "any",
      "state": ["ESTABLISHED", "RELATED"],
      "action": "ACCEPT",
      "log": false
    },
    {
      "id": 2,
      "name": "drop_invalid",
      "description": "Drop invalid packets",
      "enabled": true,
      "priority": 110,
      "direction": "INPUT",
      "protocol": "all",
      "source": "any",
      "destination": "any",
      "state": ["INVALID"],
      "action": "DROP",
      "log": true
    },
    {
      "id": 3,
      "name": "allow_loopback",
      "description": "Allow loopback traffic",
      "enabled": true,
      "priority": 120,
      "direction": "INPUT",
      "protocol": "all",
      "source": "127.0.0.0/8",
      "destination": "127.0.0.0/8",
      "action": "ACCEPT",
      "log": false
    },
    {
      "id": 4,
      "name": "allow_icmp",
      "description": "Allow ICMP ping",
      "enabled": true,
      "priority": 130,
      "direction": "INPUT",
      "protocol": "icmp",
      "source": "any",
      "destination": "any",
      "icmp_type": ["echo-request", "echo-reply"],
      "rate_limit": "10/second",
      "action": "ACCEPT",
      "log": false
    },
    {
      "id": 5,
      "name": "allow_ssh",
      "description": "Allow SSH from trusted networks",
      "enabled": true,
      "priority": 140,
      "direction": "INPUT",
      "protocol": "tcp",
      "source": "trusted",
      "destination": "any",
      "destination_port": 22,
      "action": "ACCEPT",
      "log": true,
      "rate_limit": "5/minute"
    },
    {
      "id": 6,
      "name": "allow_http",
      "description": "Allow HTTP traffic",
      "enabled": true,
      "priority": 150,
      "direction": "INPUT",
      "protocol": "tcp",
      "source": "any",
      "destination": "any",
      "destination_port": [80, 443],
      "action": "ACCEPT",
      "log": false
    },
    {
      "id": 7,
      "name": "allow_dns",
      "description": "Allow DNS queries",
      "enabled": true,
      "priority": 160,
      "direction": "INPUT",
      "protocol": ["tcp", "udp"],
      "source": "any",
      "destination": "any",
      "destination_port": 53,
      "action": "ACCEPT",
      "log": false
    },
    {
      "id": 8,
      "name": "block_port_scan",
      "description": "Block detected port scanning",
      "enabled": true,
      "priority": 50,
      "direction": "INPUT",
      "protocol": "tcp",
      "source": "any",
      "destination": "any",
      "tcp_flags": {"syn": true, "ack": false, "fin": false, "rst": false},
      "rate_limit": "25/second",
      "action": "DROP",
      "log": true
    },
    {
      "id": 9,
      "name": "block_syn_flood",
      "description": "Protection against SYN flood attacks",
      "enabled": true,
      "priority": 45,
      "direction": "INPUT",
      "protocol": "tcp",
      "source": "any",
      "destination": "any",
      "tcp_flags": {"syn": true},
      "rate_limit": "100/second",
      "burst": 200,
      "action": "DROP",
      "log": true
    },
    {
      "id": 10,
      "name": "default_drop_input",
      "description": "Default drop for input",
      "enabled": true,
      "priority": 1000,
      "direction": "INPUT",
      "protocol": "all",
      "source": "any",
      "destination": "any",
      "action": "DROP",
      "log": true
    }
  ],
  
  "rate_limits": {
    "global": {
      "packets_per_second": 100000,
      "connections_per_second": 10000
    },
    "per_ip": {
      "new_connections_per_second": 50,
      "packets_per_second": 1000
    }
  },
  
  "blacklist": {
    "enabled": true,
    "auto_update": true,
    "sources": [
      "threat_intelligence",
      "local_detection",
      "manual"
    ],
    "duration_minutes": 1440,
    "ips": []
  },
  
  "whitelist": {
    "enabled": true,
    "ips": [],
    "networks": []
  },
  
  "geo_blocking": {
    "enabled": false,
    "blocked_countries": [],
    "allowed_countries": []
  }
}

